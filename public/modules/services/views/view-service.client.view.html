<!-- <section data-ng-controller="ServicesController" data-ng-init="findOne()">
    <div class="page-header">
        <h1 data-ng-bind="service.business_name"></h1>
    </div>
    <div class="pull-right" data-ng-show="user.id == service.merchant_id">
        <a class="btn btn-primary" href="/services/{{service.id}}/edit">
            <i class="glyphicon glyphicon-edit"></i>
        </a>
        <a class="btn btn-primary" data-ng-click="remove();">
            <i class="glyphicon glyphicon-trash"></i>
        </a>
    </div>
    <small>
        <em class="text-muted">
            Posted on
            <span data-ng-bind="service.created | date:'mediumDate'"></span>
            by
            <span data-ng-bind="service.merchant_id"></span>
        </em>
    </small>
    <p class="lead" data-ng-bind="service.business_description"></p>
    <p class="lead" data-ng-bind="service.business_address_city"></p>
</section> -->
<section data-ng-controller="ViewServicesController" data-ng-init="finder()">
    <section id="business_detail">
        <div class="row green lighten-5" style="border-bottom: 1px solid rgba(0,0,0,0.1);">
            <div class="col m6 s12">
                <ul class="m-t-lg collection">
                    <li class="collection-item service-avatar">
                        <div class="row">
                            <div class="col s12">
                                <a href=""><img src="{{service.images[0].url ? service.images[0].url : 'http://placehold.it/200x200'}}" class="square-mid"></a>
                                <p class="text-sm_bold m-b-sm" ng-bind="service.business_name">
                                    <a href="" class="blue-text darken-4"></a>
                                </p>
                                <p><span class="grey-text meta-text" ng-bind="categories[service.business_category_id]"></span></p>
                                <div class="m-t-sm">
                                    <div star-rating rating-value="avg_rating" max="5" readonly="true"></div>
                                    <span>{{service.reviews.length}} Review</span><span ng-if="service.reviews.length > 1">s</span>
                                    <p class="meta-text m-t-md" ng-bind="service.business_description"></p>
                                    <p class="meta-text"><a href="" ng-bind="service.business_address"><i class="fa fa-home">: </i></a></p>
                                    <p class="meta-text"><a href="" ng-bind="service.business_phone_number"><i class="fa fa-phone">: </i></a></p>
                                    <p class="meta-text"><a href="" ng-bind="service.business_email"><i class="fa fa-envelope">: </i></a></p>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="col m6 s12">
                <!-- <a href="" class="btn green darken-2 white-text m-t-lg"><i class="fa fa-star"></i> Write Review</a> -->
                <div class="list-group list-group-horizontal m-t-lg">
                    <a href="#" class="list-group-item" ng-click="toggleReview()"><i class="fa fa-star"></i> Write a Review</a>
                    <a href="/services/{{service.id}}/edit" data-ng-show="user.id == service.merchant_id" class="list-group-item"><i class="fa fa-edit"></i> Edit</a>
                    <a href="#" data-ng-show="user.id == service.merchant_id" class="list-group-item" data-ng-click="remove();"><i class="fa fa-remove"></i> Delete</a>
                </div>
            </div>
        </div>
        <div class="row m-t-lg" ng-show="showReview">
            <div class="col m6 offset-m1 s12">
                <h4 class="section-title red-text">Write your review<span class="meta-text pull-right blue-text">Read our review guidelines</span></h4>
                <hr>
                <div class="col m12">
                    <div class="row">
                        <div class="col s12 m-t-lg">
                            <div star-rating rating-value="rating" max="5" on-rating-selected="rateFunction(rating)"></div>
                            <span ng-hide="rating > 0" class="">Select a rating</span>
                            <span ng-show="rating > 0"class="">{{rating}} Star</span>
                            <div class="review m-t-lg">
                                <form name="reviewForm" class="form-horizontal" data-ng-submit="createReview()" novalidate>
                                    <div class="form-group" ng-class="{ 'has-error': reviewForm.title.$dirty && reviewForm.title.$invalid }">
                                        <div class="controls">
                                            <textarea name="review" data-ng-model="review" id="review" class="form-control" cols="30" rows="10" placeholder="Your review helps other learn about great local businesses"></textarea>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <input type="submit" class="btn btn-default" value="Post Review">
                                        <a href="" style="margin-left: 20px;" ng-click="reset()">Cancel</a>
                                        <p class="meta-text m-t-sm grey-text lighten-3">* You can always edit or remove reviews later.</p>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col m3 offset-m1 s12" ng-init="getServiceByCategory(service.business_category_id)">
                <h4 class="section-title red-text">Reviews for Similar Businesses</h4>
                <hr>
                <ul class="collection m-b-lg">
                    <li ng-repeat="service in categoryArr" class="collection-item avatar">
                        <a href=""><img src="{{service.images[0].url ? service.images[0].url : 'http://placehold.it/60x60'}}" class="square"></a>
                        <p class="text-sm_bold m-b-md"><a href="/services/{{service.id}}" class="blue-text darken-4" ng-bind="service.business_name"></a></p>
                        <p class="red-text"> <div star-rating rating-value="service.avg_rating" max="5" readonly="true" class="small-star"></div> <span>{{service.reviews.length}} Review</span><span ng-if="service.reviews.length > 1">s</span></p>
                        <div class="review m-t-sm" ng-show="service.reviews.length">
                            <a href=""><img src="{{service.reviews[0].User.image_url}}" class="img img-responsive avatar"></a>
                            <p class="meta-text" ng-bind="service.reviews[0].review"></p>
                        </div>
                        <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a>
                    </li>
                </ul>
            </div> -->
        </div>
        <div class="row">
            <div class="col m6 s12">
                <div ng-hide="user.id === service.merchant_id || reviews.length">
                    <h4>No review yet. Be the first to <a href="" ui-sref=".createReview">write a review.</a></h4>
                </div>
                <div class="col m12">
                <h3 class="section-title red-text flow-text">Recommended Reviews</h3>
                    <hr>
                    <ul class="collection m-b-lg">
                        <li ng-repeat="review in reviews | orderBy: '-created' | limitTo:10" class="collection-item avatar">
                            <div class="row">
                                <div class="col s4">
                                    <a href=""><img src="{{review.User.image_url}}" class="square"></a>
                                    <p class="m-b-md"><a href="" class="blue-text darken-4">{{review.User.displayname}}</a></p>
                                    <p><i class="fa fa-star red-text"></i> {{review.totalRev}} Review<span ng-if="review.totalRev > 1">s</span></span></p>
                                </div>
                                <div class="col s8">
                                    <div star-rating rating-value="review.value" max="5" readonly="true"></div>
                                    <span class="meta-text">{{review.created | date:'mediumDate'}}</span>
                                    <div class="review m-t-md">
                                        <!-- <a href=""><img src="http://placehold.it/30x30" class="avatar"></a> -->
                                        <p ng-bind="review.review"></p>
                                    </div>
                                    <!-- <p class="m-t-md">
                                        <img src="http://placehold.it/300x300" class="img img-responsive">
                                    </p> -->
                                    <p class="meta-text m-t-md">What do you think of this review?
                                        <p class="m-t-md"><a href="" ng-click="like(review)"><span><i class="fa fa-thumbs-o-up"></i> {{review.no_of_likes}}</span><span> Like</span><span ng-if="review.no_of_likes > 1">s</span></a> 
                                        <a href="" ng-click="dislike(review)"><span><i class="fa fa-thumbs-o-down"></i> {{review.no_of_dislikes}}</span><span> Dislike</span><span ng-if="review.no_of_dislikes > 1">s</span></a></p>
                                    </p>
                                </div>
                            </div>
                            <!-- <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a> -->
                        </li>
                        
                    </ul>
                </div>
            </div>
            <div class="col m4 offset-m1 s12">
                <h3 class="section-title red-text flow-text">People also reviewed</h3>
                <hr>
                <ul class="collection m-b-lg" ng-init="findReviews()">
                    <li ng-repeat="review in topReviews" class="collection-item avatar">
                        <a href=""><img src="{{review.img ? review.img : 'http://placehold.it/60x60'}}" class="square"></a>
                        <p class="m-b-md"><a href="" class="blue-text darken-4">{{review.firstname}}</a> wrote for <a href="/services/{{review.service_id}}" class="text-sm_bold blue-text darken-4">{{review.business_name}}</a></p>
                        <p class="red-text"><div star-rating rating-value="review.value" max="5" readonly="true" class="small-star"></div><span class="grey-text meta-text">{{review.created | date:'mediumDate'}}</span></p>
                        <div class="review m-t-sm">
                            <!-- <a href=""><img src="http://placehold.it/30x30" class="avatar"></a> -->
                            <p class="meta-text">{{review.review}}.</p>
                        </div>
                        <!-- <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a> -->
                    </li>
                </ul>
            </div>
        </div>
    </section>
</section>
